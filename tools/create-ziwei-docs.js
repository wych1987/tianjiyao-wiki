#!/usr/bin/env node

/**
 * æ‰©å……ç´«å¾®æ–—æ•°æ¨¡å—
 * åˆ›å»ºç´«å¾®æ–—æ•°çš„æ ¸å¿ƒç†è®ºæ–‡æ¡£
 */

require('dotenv').config();
const axios = require('axios');
const fs = require('fs');
const path = require('path');

const DEEPSEEK_API_KEY = process.env.DEEPSEEK_API_KEY;
const DEEPSEEK_API_URL = 'https://api.deepseek.com/v1/chat/completions';

// ç´«å¾®æ–—æ•°æ¨¡å—æ–‡æ¡£é…ç½®
const ziweiDocs = [
  {
    filename: 'palaces.md',
    dir: 'docs/ziwei',
    title: 'ç´«å¾®æ–—æ•°åäºŒå®«ä½è¯¦è§£ï¼šå‘½è¿å…¨æ™¯è§£æ',
    description: 'ç³»ç»Ÿé˜è¿°ç´«å¾®æ–—æ•°åäºŒå®«ä½çš„å«ä¹‰ã€åˆ¤æ–­æ–¹æ³•åŠå„å®«æ˜Ÿæ›œçš„å‰å‡¶åˆ†æï¼Œå…¨é¢æŒæ¡å®«ä½è§£è¯»æŠ€å·§',
    keywords: ['åäºŒå®«ä½', 'å‘½å®«', 'è´¢å¸›å®«', 'å®˜ç¦„å®«', 'è¿ç§»å®«', 'å¤«å¦»å®«', 'å­å¥³å®«', 'ç´«å¾®æ–—æ•°', 'å®«ä½è§£æ'],
    prompt: `è¯·æ’°å†™ä¸€ç¯‡å…³äº"ç´«å¾®æ–—æ•°åäºŒå®«ä½"çš„ä¸“ä¸šå­¦æœ¯æ–‡ç« ï¼Œè¦æ±‚ï¼š

1. **å®«ä½æ¦‚è¿°**ï¼šåäºŒå®«ä½çš„ç†è®ºåŸºç¡€å’Œæ•´ä½“æ¡†æ¶
2. **å‘½å®«è¯¦è§£**ï¼šå‘½å®«çš„æ ¸å¿ƒåœ°ä½ã€åˆ¤æ–­æ–¹æ³•ã€æ˜Ÿæ›œç»„åˆ
3. **å…„å¼Ÿå®«**ï¼šå…„å¼Ÿå§å¦¹å…³ç³»ã€æœ‹å‹äº¤å¾€çš„åˆ¤æ–­
4. **å¤«å¦»å®«**ï¼šå©šå§»æ„Ÿæƒ…ã€é…å¶ç‰¹è´¨çš„åˆ†æ
5. **å­å¥³å®«**ï¼šå­å¥³å…³ç³»ã€ç”Ÿè‚²ã€æ¡ƒèŠ±çš„è§£è¯»
6. **è´¢å¸›å®«**ï¼šè´¢è¿ã€ç†è´¢èƒ½åŠ›çš„åˆ¤æ–­
7. **ç–¾å„å®«**ï¼šå¥åº·çŠ¶å†µã€ä½“è´¨çš„åˆ†æ
8. **è¿ç§»å®«**ï¼šå¤–å‡ºè¿ã€äººé™…å…³ç³»çš„åˆ¤æ–­
9. **å¥´ä»†å®«**ï¼šä¸‹å±ã€æœ‹å‹ã€ç¤¾äº¤çš„è§£è¯»
10. **å®˜ç¦„å®«**ï¼šäº‹ä¸šã€å·¥ä½œã€åœ°ä½çš„åˆ†æ
11. **ç”°å®…å®«**ï¼šä¸åŠ¨äº§ã€å®¶åº­ç¯å¢ƒçš„åˆ¤æ–­
12. **ç¦å¾·å®«**ï¼šç²¾ç¥ç”Ÿæ´»ã€å…´è¶£çˆ±å¥½çš„è§£è¯»
13. **çˆ¶æ¯å®«**ï¼šçˆ¶æ¯å…³ç³»ã€é•¿è¾ˆç¼˜åˆ†çš„åˆ†æ
14. **å®«ä½äº’åŠ¨**ï¼šä¸‰æ–¹å››æ­£ã€å¯¹å®«çš„ç›¸äº’å½±å“
15. **å®è·µæ¡ˆä¾‹**ï¼šå®Œæ•´çš„å®«ä½åˆ†æç¤ºä¾‹

è¦æ±‚ï¼š
- æ¯ä¸ªå®«ä½è¯¦ç»†è§£æ
- åŒ…å«æ˜Ÿæ›œç»„åˆåˆ¤æ–­
- æä¾›å®ç”¨åˆ†ææ–¹æ³•
- å­—æ•°5000-6000å­—`
  },
  {
    filename: 'four-transformations.md',
    dir: 'docs/ziwei',
    title: 'ç´«å¾®æ–—æ•°å››åŒ–é£æ˜Ÿç†è®ºï¼šåŠ¨æ€å‘½è¿çš„è§£ç ',
    description: 'æ·±å…¥æ¢è®¨åŒ–ç¦„ã€åŒ–æƒã€åŒ–ç§‘ã€åŒ–å¿Œå››åŒ–é£æ˜Ÿçš„ç†è®ºåŸºç¡€ã€åº”ç”¨è§„åˆ™åŠå®æˆ˜æŠ€å·§ï¼ŒæŒæ¡ç´«å¾®æ–—æ•°çš„ç²¾é«“',
    keywords: ['å››åŒ–', 'åŒ–ç¦„', 'åŒ–æƒ', 'åŒ–ç§‘', 'åŒ–å¿Œ', 'é£æ˜Ÿ', 'ç´«å¾®æ–—æ•°', 'åŠ¨æ€åˆ†æ'],
    prompt: `è¯·æ’°å†™ä¸€ç¯‡å…³äº"ç´«å¾®æ–—æ•°å››åŒ–é£æ˜Ÿ"çš„é«˜çº§ä¸“ä¸šæ–‡ç« ï¼Œè¦æ±‚ï¼š

1. **å››åŒ–ç†è®ºåŸºç¡€**ï¼šå››åŒ–çš„èµ·æºã€å“²å­¦å†…æ¶µã€åœ¨ç´«å¾®æ–—æ•°ä¸­çš„åœ°ä½
2. **åŒ–ç¦„è¯¦è§£**ï¼šåŒ–ç¦„çš„å«ä¹‰ã€ä½œç”¨æœºåˆ¶ã€å‰å‡¶åˆ¤æ–­
3. **åŒ–æƒè¯¦è§£**ï¼šåŒ–æƒçš„ç‰¹ç‚¹ã€æƒåŠ›è¡¨ç°ã€åº”ç”¨æ–¹æ³•
4. **åŒ–ç§‘è¯¦è§£**ï¼šåŒ–ç§‘çš„æ„ä¹‰ã€åå£°åœ°ä½ã€åˆ¤æ–­æŠ€å·§
5. **åŒ–å¿Œè¯¦è§£**ï¼šåŒ–å¿Œçš„æœ¬è´¨ã€å‡¶é™©åŒ–è§£ã€æ³¨æ„äº‹é¡¹
6. **å››åŒ–é£æ˜Ÿè§„åˆ™**ï¼š
   - ç”Ÿå¹´å››åŒ–
   - å¤§é™å››åŒ–
   - æµå¹´å››åŒ–
   - æµæœˆæµæ—¥å››åŒ–
7. **é£æ˜ŸæŠ€å·§**ï¼šè‡ªåŒ–ã€å åŒ–ã€äº’åŒ–çš„åˆ†ææ–¹æ³•
8. **å®«ä½é£åŒ–**ï¼šä¸åŒå®«ä½å››åŒ–çš„å«ä¹‰å’Œå½±å“
9. **å››åŒ–ç»„åˆ**ï¼šå¤šé‡å››åŒ–çš„ç»¼åˆåˆ¤æ–­
10. **å®æˆ˜åº”ç”¨**ï¼š
    - äº‹ä¸šå‘å±•çš„å››åŒ–åˆ†æ
    - è´¢è¿åˆ¤æ–­çš„å››åŒ–è¿ç”¨
    - æ„Ÿæƒ…å©šå§»çš„å››åŒ–è§£è¯»
11. **æ¡ˆä¾‹è¯¦è§£**ï¼šå®Œæ•´çš„å››åŒ–é£æ˜Ÿåˆ†æå®ä¾‹

è¦æ±‚ï¼š
- ç†è®ºæ·±å…¥æµ…å‡º
- è§„åˆ™æ¸…æ™°æ˜ç¡®
- å®æˆ˜æ€§å¼º
- å­—æ•°5000-6000å­—`
  },
  {
    filename: 'pattern-combinations.md',
    dir: 'docs/ziwei',
    title: 'ç´«å¾®æ–—æ•°æ˜Ÿæ›œç»„åˆä¸æ ¼å±€ï¼šå‘½è¿å“è´¨çš„è¯„å®š',
    description: 'ç³»ç»Ÿè®²è§£ç´«å¾®æ–—æ•°çš„å„ç§æ˜Ÿæ›œç»„åˆã€ç»å…¸æ ¼å±€åŠå…¶åˆ¤æ–­æ ‡å‡†ï¼ŒæŒæ¡å‘½ç›˜å“è´¨çš„è¯„ä¼°æ–¹æ³•',
    keywords: ['æ˜Ÿæ›œç»„åˆ', 'ç´«å¾®æ ¼å±€', 'å›è‡£åº†ä¼š', 'è´¢å®˜æ ¼', 'å‘½å±€å±‚æ¬¡', 'æ ¼å±€é«˜ä½', 'æ˜Ÿæ›œé…ç½®'],
    prompt: `è¯·æ’°å†™ä¸€ç¯‡å…³äº"ç´«å¾®æ–—æ•°æ˜Ÿæ›œç»„åˆä¸æ ¼å±€"çš„ä¸“ä¸šæ–‡ç« ï¼Œè¦æ±‚ï¼š

1. **æ ¼å±€ç†è®ºæ¦‚è¿°**ï¼šæ ¼å±€çš„å®šä¹‰ã€åˆ†ç±»ã€é‡è¦æ€§
2. **ä¸»æ˜Ÿç»„åˆ**ï¼š
   - ç´«å¾®ç³»æ˜Ÿæ›œç»„åˆ
   - å¤©åºœç³»æ˜Ÿæ›œç»„åˆ
   - æ€ç ´ç‹¼ç»„åˆ
   - æœºæœˆåŒæ¢ç»„åˆ
3. **ç»å…¸å‰æ ¼**ï¼š
   - å›è‡£åº†ä¼šæ ¼
   - ç´«åºœæœå£æ ¼
   - å¤©åºœæœå£æ ¼
   - æœºæœˆåŒæ¢æ ¼
   - é˜³æ¢æ˜Œç¦„æ ¼
   - æ˜ç å‡ºæµ·æ ¼
   - é‡‘ç¿å…‰è¾‰æ ¼
4. **ç»å…¸å‡¶æ ¼**ï¼š
   - ç¾Šé™€å¤¹å¿Œæ ¼
   - ç«é“ƒå¤¹å‘½æ ¼
   - ç©ºåŠ«å¤¹å‘½æ ¼
   - é©¬å¤´å¸¦å‰‘æ ¼
5. **æ˜Ÿæ›œé…ç½®åŸåˆ™**ï¼š
   - ä¸»æ˜Ÿä¸è¾…æ˜Ÿçš„æ­é…
   - å‰æ˜Ÿå‡¶æ˜Ÿçš„å½±å“
   - ä¸‰æ–¹å››æ­£çš„é…ç½®
6. **æ ¼å±€å±‚æ¬¡åˆ¤æ–­**ï¼š
   - ä¸Šç­‰æ ¼å±€ç‰¹å¾
   - ä¸­ç­‰æ ¼å±€ç‰¹å¾
   - ä¸‹ç­‰æ ¼å±€ç‰¹å¾
   - ç ´æ ¼ä¸æ•‘åº”
7. **ç°ä»£åº”ç”¨**ï¼šæ ¼å±€ç†è®ºåœ¨ç°ä»£ç¤¾ä¼šçš„è§£è¯»
8. **å®æˆ˜åˆ†æ**ï¼š
   - ä¼ä¸šå®¶å‘½ç›˜æ ¼å±€åˆ†æ
   - å­¦è€…å‘½ç›˜æ ¼å±€åˆ†æ
   - è‰ºæœ¯å®¶å‘½ç›˜æ ¼å±€åˆ†æ

è¦æ±‚ï¼š
- ç³»ç»Ÿæ€§å¼º
- åˆ†ç±»æ¸…æ™°
- å®ä¾‹ä¸°å¯Œ
- å­—æ•°4500-5500å­—`
  },
  {
    filename: 'practical-analysis.md',
    dir: 'docs/ziwei',
    title: 'ç´«å¾®æ–—æ•°å®æˆ˜åˆ†ææ–¹æ³•ï¼šä»ç†è®ºåˆ°å®è·µ',
    description: 'è¯¦è§£ç´«å¾®æ–—æ•°çš„å®Œæ•´åˆ†ææµç¨‹ã€åˆ¤æ–­æŠ€å·§åŠå®æˆ˜æ¡ˆä¾‹ï¼Œå¸®åŠ©å­¦ä¹ è€…å°†ç†è®ºè½¬åŒ–ä¸ºå®è·µèƒ½åŠ›',
    keywords: ['å®æˆ˜åˆ†æ', 'æ’ç›˜æŠ€å·§', 'åˆ¤æ–­æµç¨‹', 'å‘½ç›˜è§£è¯»', 'ç»¼åˆåˆ†æ', 'ç´«å¾®å®è·µ'],
    prompt: `è¯·æ’°å†™ä¸€ç¯‡å…³äº"ç´«å¾®æ–—æ•°å®æˆ˜åˆ†æ"çš„å®ç”¨æ•™ç¨‹æ–‡ç« ï¼Œè¦æ±‚ï¼š

1. **æ’ç›˜åŸºç¡€**ï¼š
   - æ’ç›˜å·¥å…·çš„é€‰æ‹©å’Œä½¿ç”¨
   - å‘½ç›˜ä¿¡æ¯çš„å‡†ç¡®å½•å…¥
   - æ’ç›˜ç»“æœçš„åˆæ­¥æ£€æŸ¥
2. **åˆ†ææµç¨‹**ï¼š
   - ç¬¬ä¸€æ­¥ï¼šç¡®å®šå‘½å®«ä¸»æ˜Ÿå’Œæ ¼å±€
   - ç¬¬äºŒæ­¥ï¼šåˆ†æä¸‰æ–¹å››æ­£é…ç½®
   - ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹åäºŒå®«ä½æ˜Ÿæ›œ
   - ç¬¬å››æ­¥ï¼šå››åŒ–é£æ˜Ÿçš„åˆ¤æ–­
   - ç¬¬äº”æ­¥ï¼šå¤§é™æµå¹´çš„æ¨æ¼”
   - ç¬¬å…­æ­¥ï¼šç»¼åˆè¯„ä¼°å’Œç»“è®º
3. **å‘½ç›˜è§£è¯»æŠ€å·§**ï¼š
   - å…ˆçœ‹æ ¼å±€å±‚æ¬¡
   - å†çœ‹æ˜Ÿæ›œç»„åˆ
   - ä¸‰çœ‹å››åŒ–ä½œç”¨
   - å››çœ‹å®«ä½å¼ºå¼±
   - äº”çœ‹æµå¹´åŠ¨æ€
4. **å„é¢†åŸŸåˆ†ææ–¹æ³•**ï¼š
   - äº‹ä¸šå‘å±•åˆ†æ
   - è´¢è¿çŠ¶å†µåˆ†æ
   - å©šå§»æ„Ÿæƒ…åˆ†æ
   - å¥åº·çŠ¶å†µåˆ†æ
   - äººé™…å…³ç³»åˆ†æ
5. **å¸¸è§é—®é¢˜å¤„ç†**ï¼š
   - å‡ºç”Ÿæ—¶é—´ä¸å‡†ç¡®çš„å¤„ç†
   - å¤šç§åˆ¤æ–­ç›¸çŸ›ç›¾çš„å¤„ç†
   - å‡¶æ ¼çš„åŒ–è§£æ–¹æ³•
   - æµå¹´ä¸åˆ©çš„åº”å¯¹
6. **å®æˆ˜æ¡ˆä¾‹**ï¼ˆè‡³å°‘3ä¸ªå®Œæ•´æ¡ˆä¾‹ï¼‰ï¼š
   - æ¡ˆä¾‹ä¸€ï¼šäº‹ä¸šå‹å‘½ç›˜åˆ†æ
   - æ¡ˆä¾‹äºŒï¼šè´¢å¯Œå‹å‘½ç›˜åˆ†æ
   - æ¡ˆä¾‹ä¸‰ï¼šæ„Ÿæƒ…å‹å‘½ç›˜åˆ†æ
7. **åˆ†ææ³¨æ„äº‹é¡¹**ï¼š
   - é¿å…ç»å¯¹åŒ–åˆ¤æ–­
   - æ³¨é‡æ•´ä½“æŠŠæ¡
   - ç»“åˆç°å®æƒ…å†µ
   - ä¿æŒå®¢è§‚ç†æ€§

è¦æ±‚ï¼š
- å®ç”¨æ€§å¼º
- æ­¥éª¤æ¸…æ™°
- æ¡ˆä¾‹è¯¦ç»†
- å­—æ•°4500-5500å­—`
  },
  {
    filename: 'advanced-techniques.md',
    dir: 'docs/ziwei',
    title: 'ç´«å¾®æ–—æ•°é«˜çº§æŠ€æ³•ï¼šæ·±å±‚æ¬¡å‘½ç†æ¢ç´¢',
    description: 'æ¢è®¨ç´«å¾®æ–—æ•°çš„é«˜çº§åˆ†ææŠ€æ³•ï¼ŒåŒ…æ‹¬å°é™æµæ—¥ã€ç¥ç…åº”ç”¨ã€ç‰¹æ®Šå‘½æ ¼ç­‰æ·±åº¦å†…å®¹',
    keywords: ['é«˜çº§æŠ€æ³•', 'å°é™', 'æµæ—¥', 'ç¥ç…', 'ç‰¹æ®Šå‘½æ ¼', 'é«˜é˜¶åˆ†æ', 'ç´«å¾®è¿›é˜¶'],
    prompt: `è¯·æ’°å†™ä¸€ç¯‡å…³äº"ç´«å¾®æ–—æ•°é«˜çº§æŠ€æ³•"çš„æ·±åº¦ä¸“ä¸šæ–‡ç« ï¼Œè¦æ±‚ï¼š

1. **æ—¶é—´ç»´åº¦çš„æ·±å…¥åˆ†æ**ï¼š
   - å¤§é™ï¼ˆ10å¹´è¿ï¼‰çš„ç²¾ç»†åˆ¤æ–­
   - æµå¹´ï¼ˆå¹´è¿ï¼‰çš„è¯¦ç»†åˆ†æ
   - æµæœˆï¼ˆæœˆè¿ï¼‰çš„æ¨æ¼”æ–¹æ³•
   - æµæ—¥ï¼ˆæ—¥è¿ï¼‰çš„åº”ç”¨æŠ€å·§
   - å°é™çš„è¿ç”¨å’Œäº‰è®®
2. **ç¥ç…ç³»ç»Ÿ**ï¼š
   - ä¸»è¦ç¥ç…çš„ä½œç”¨
   - æµå¹´ç¥ç…çš„åº”ç”¨
   - ç¥ç…ä¸ä¸»æ˜Ÿçš„é…åˆ
   - ç¥ç…çš„ç°ä»£è§£è¯»
3. **ç‰¹æ®Šå‘½æ ¼ç ”ç©¶**ï¼š
   - åŒæ˜ŸåŒå®«çš„ç‰¹æ®Šæ€§
   - ç©ºå®«çš„åˆ¤æ–­æ–¹æ³•
   - å€Ÿæ˜Ÿå®‰å®«æŠ€å·§
   - ç‰¹æ®Šæ ¼å±€çš„è¯†åˆ«
4. **é«˜çº§å››åŒ–æŠ€å·§**ï¼š
   - æš—åˆé£åŒ–
   - è¿ç¯å››åŒ–
   - å››åŒ–å†²ç ´
   - å››åŒ–åˆ¶åŒ–
5. **å®«ä½æ·±åº¦åˆ†æ**ï¼š
   - å¯¹å®«ä½œç”¨åŠ›
   - ä¸‰æ–¹ä¼šç…§
   - æš—åˆæ˜åˆ
   - å…­äº²å®«ä½äº’åŠ¨
6. **é¢„æµ‹æŠ€å·§**ï¼š
   - æµå¹´å¤§äº‹çš„é¢„æµ‹
   - å…·ä½“æ—¶é—´ç‚¹çš„åˆ¤æ–­
   - å‰å‡¶ç¨‹åº¦çš„é‡åŒ–
   - è¶‹å‰é¿å‡¶çš„æ–¹æ³•
7. **ç°ä»£åº”ç”¨åˆ›æ–°**ï¼š
   - å¿ƒç†å­¦è§’åº¦çš„è§£è¯»
   - èŒä¸šè§„åˆ’çš„åº”ç”¨
   - æŠ•èµ„ç†è´¢çš„å‚è€ƒ
   - äººç”Ÿè§„åˆ’çš„æŒ‡å¯¼
8. **æ¡ˆä¾‹ç ”ç©¶**ï¼š
   - å†å²åäººå‘½ç›˜åˆ†æ
   - ç‰¹æ®Šå‘½æ ¼å®ä¾‹è§£æ
   - å‡†ç¡®é¢„æµ‹æ¡ˆä¾‹åˆ†äº«

è¦æ±‚ï¼š
- ç†è®ºæ·±åº¦
- æŠ€æ³•ç²¾å‡†
- å®ä¾‹è®ºè¯
- å­—æ•°4000-5000å­—`
  }
];

// å­¦æœ¯èµ„æºé…ç½®
const academicResources = {
  ziwei: [
    'æ¸…åå¤§å­¦ã€Šä¸­å›½ä¼ ç»Ÿæ–‡åŒ–ç ”ç©¶ã€‹',
    'åŒ—äº¬å¤§å­¦å“²å­¦ç³»ã€Šä¸­å›½å“²å­¦å²ã€‹',
    'ä¸­å›½äººæ°‘å¤§å­¦ã€Šæ˜“å­¦ç ”ç©¶ã€‹',
    'åŒ—äº¬å¸ˆèŒƒå¤§å­¦ã€Šä¸­å›½æ–‡åŒ–ç ”ç©¶ã€‹',
    'å¤æ—¦å¤§å­¦ã€Šä¸­å›½å¤ä»£æ€æƒ³å²ã€‹',
    'ä¸­å±±å¤§å­¦ã€Šå²­å—æ–‡åŒ–ç ”ç©¶ã€‹',
    'Stanford Universityã€Šä¸œäºšæ–‡åŒ–ç ”ç©¶ã€‹',
    'ã€Šç´«å¾®æ–—æ•°å…¨ä¹¦ã€‹ï¼ˆæ˜Â·é™ˆå¸Œå¤·ä¼ ï¼‰',
    'ã€Šç´«å¾®æ–—æ•°å…¨é›†ã€‹ï¼ˆæ¸…Â·ç‹äº­ä¹‹ï¼‰',
    'ã€Šæ–—æ•°å®£å¾®ã€‹ï¼ˆæ¸…Â·ä½™æ˜¥å°ï¼‰',
    'ã€Šç´«å¾®æ–—æ•°è®²ä¹‰ã€‹ï¼ˆç°ä»£Â·é™†æ–Œå…†ï¼‰',
    'ã€Šç´«å¾®æ–—æ•°ç²¾æˆã€‹ï¼ˆç°ä»£Â·æ…§å¿ƒæ–‹ä¸»ï¼‰',
    'ã€Šé£æ˜Ÿç´«å¾®æ–—æ•°ã€‹ï¼ˆç°ä»£Â·æ–¹å¤–äººï¼‰',
    'ã€Šç´«å¾®æ–—æ•°æ·±é€ è®²ä¹‰ã€‹ï¼ˆç°ä»£Â·å¾å¢ç”Ÿï¼‰',
    'ã€Šæ˜“ç»ã€‹ç³»è¾ä¼ ',
    'ã€Šé»„å¸å†…ç»ã€‹å¤©äººç›¸åº”ç†è®º'
  ]
};

async function generateContent(docConfig) {
  console.log(`\nğŸ”„ æ­£åœ¨ç”Ÿæˆ: ${docConfig.title}`);
  
  const systemPrompt = `ä½ æ˜¯ä¸€ä½èµ„æ·±çš„ç´«å¾®æ–—æ•°ç ”ç©¶å­¦è€…ï¼Œç²¾é€šä¸­å›½ä¼ ç»Ÿå‘½ç†å­¦å’Œç´«å¾®æ–—æ•°ä½“ç³»ã€‚
ä½ çš„ä»»åŠ¡æ˜¯æ’°å†™é«˜è´¨é‡çš„å­¦æœ¯æ–‡ç« ï¼Œè¦æ±‚ï¼š
1. å†…å®¹å‡†ç¡®ã€ä¸“ä¸šï¼ŒåŸºäºç»å…¸æ–‡çŒ®å’Œç°ä»£ç ”ç©¶
2. ç»“æ„æ¸…æ™°ï¼Œå±‚æ¬¡åˆ†æ˜
3. æ—¢æœ‰ç†è®ºæ·±åº¦ï¼Œåˆæ³¨é‡å®ç”¨æ€§
4. åŒ…å«å…·ä½“çš„åˆ†ææ–¹æ³•å’Œå®æˆ˜æ¡ˆä¾‹
5. å¼•ç”¨æƒå¨æ–‡çŒ®ï¼Œä½“ç°å­¦æœ¯æ€§
6. è¯­è¨€ä¸“ä¸šä½†é€šä¿—æ˜“æ‡‚

å¯å‚è€ƒçš„æƒå¨èµ„æºï¼š
${academicResources.ziwei.map(r => `- ${r}`).join('\n')}

è¯·ç¡®ä¿å†…å®¹çš„å‡†ç¡®æ€§å’Œä¸“ä¸šæ€§ï¼Œé¿å…è¿·ä¿¡è‰²å½©ã€‚`;

  try {
    const response = await axios.post(
      DEEPSEEK_API_URL,
      {
        model: 'deepseek-chat',
        messages: [
          { role: 'system', content: systemPrompt },
          { role: 'user', content: docConfig.prompt }
        ],
        temperature: 0.7,
        max_tokens: 8000
      },
      {
        headers: {
          'Authorization': `Bearer ${DEEPSEEK_API_KEY}`,
          'Content-Type': 'application/json'
        },
        timeout: 120000
      }
    );

    return response.data.choices[0].message.content;
  } catch (error) {
    console.error(`âŒ APIè°ƒç”¨å¤±è´¥:`, error.message);
    throw error;
  }
}

function createMarkdownFile(docConfig, content) {
  const frontMatter = `---
layout: default
title: ${docConfig.title}
description: ${docConfig.description}
keywords: [${docConfig.keywords.join(', ')}]
author: ç´«å¾®æ–—æ•°ç ”ç©¶å›¢é˜Ÿ
date: ${new Date().toISOString().split('T')[0]}
---

`;

  const relatedLinks = `

---

## ğŸ“š ç›¸å…³é˜…è¯»

- [è¿”å›ç´«å¾®æ–—æ•°é¦–é¡µ](./index.md)
- [ç´«å¾®æ–—æ•°æ˜Ÿæ›œä½“ç³»](./stars.md)
- [å…«å­—å‘½ç†å­¦ä¹ ](../bazi/index.md)
- [AIä¸ä¼ ç»Ÿç„å­¦](../ai/ai-introduction.md)
`;

  const fullContent = frontMatter + content + relatedLinks;
  const filePath = path.join(__dirname, docConfig.dir, docConfig.filename);
  
  // ç¡®ä¿ç›®å½•å­˜åœ¨
  const dir = path.dirname(filePath);
  if (!fs.existsSync(dir)) {
    fs.mkdirSync(dir, { recursive: true });
  }
  
  fs.writeFileSync(filePath, fullContent, 'utf-8');
  console.log(`âœ… å·²åˆ›å»º: ${docConfig.dir}/${docConfig.filename}`);
}

async function main() {
  console.log('ğŸŒŸ å¼€å§‹åˆ›å»ºç´«å¾®æ–—æ•°æ¨¡å—æ–‡æ¡£...\n');
  console.log(`ğŸ“‹ è®¡åˆ’åˆ›å»º ${ziweiDocs.length} ä¸ªæ–‡æ¡£\n`);

  if (!DEEPSEEK_API_KEY) {
    console.error('âŒ é”™è¯¯: æœªæ‰¾åˆ°DEEPSEEK_API_KEYç¯å¢ƒå˜é‡');
    console.log('ğŸ’¡ è¯·åœ¨.envæ–‡ä»¶ä¸­è®¾ç½®: DEEPSEEK_API_KEY=your_key_here');
    process.exit(1);
  }

  let successCount = 0;
  let failCount = 0;

  for (const docConfig of ziweiDocs) {
    try {
      const content = await generateContent(docConfig);
      createMarkdownFile(docConfig, content);
      successCount++;
      
      // é¿å…APIé™æµ
      console.log('â³ ç­‰å¾…2ç§’ä»¥é¿å…APIé™æµ...');
      await new Promise(resolve => setTimeout(resolve, 2000));
    } catch (error) {
      console.error(`âŒ åˆ›å»º ${docConfig.filename} å¤±è´¥:`, error.message);
      failCount++;
    }
  }

  console.log('\n' + '='.repeat(60));
  console.log('ğŸ“Š ç´«å¾®æ–—æ•°æ¨¡å—åˆ›å»ºå®Œæˆç»Ÿè®¡:');
  console.log(`   âœ… æˆåŠŸ: ${successCount} ä¸ªæ–‡æ¡£`);
  console.log(`   âŒ å¤±è´¥: ${failCount} ä¸ªæ–‡æ¡£`);
  console.log('='.repeat(60));

  if (successCount > 0) {
    console.log('\nğŸ’¡ ä¸‹ä¸€æ­¥å»ºè®®:');
    console.log('   1. è¿è¡Œ npm run analyze æ£€æŸ¥æ–‡æ¡£è´¨é‡');
    console.log('   2. å®¡é˜…ç”Ÿæˆçš„å†…å®¹');
    console.log('   3. è¿è¡Œ npm run create-ai-docs åˆ›å»ºAIæ¨¡å—');
  }
}

main().catch(console.error);
