#!/usr/bin/env node

/**
 * 创建周易八卦模块文档
 * 6-8篇高质量文档，完善传统命理三大支柱
 */

require('dotenv').config();
const axios = require('axios');
const fs = require('fs');
const path = require('path');

const DEEPSEEK_API_KEY = process.env.DEEPSEEK_API_KEY;
const DEEPSEEK_API_URL = 'https://api.deepseek.com/v1/chat/completions';

const documents = [
  {
    filename: 'index.md',
    title: '周易八卦概论：中华预测学的哲学基石',
    description: '系统介绍周易八卦的起源、发展、理论体系及在传统预测学中的核心地位',
    keywords: ['周易', '八卦', '易经', '卦象', '预测学', '中国哲学', '六十四卦'],
    author: '周易研究团队',
    prompt: `请撰写一篇5000-6000字的周易八卦概论文章，内容包括：

1. **历史渊源与发展脉络**：
   - 伏羲画卦的传说与考证
   - 文王演易的历史贡献
   - 孔子作传的学术价值
   - 历代易学的发展演变
   - 现代易学研究成果
2. **八卦的基本概念与符号系统**：
   - 阴阳爻的基本符号
   - 八卦的组成与命名
   - 八卦的象征意义
   - 六十四卦的形成原理
3. **周易的哲学思想**：
   - 阴阳对立统一思想
   - 变化发展的辩证法
   - 天人合一的宇宙观
   - 生生不息的生命哲学
4. **周易在预测学中的地位**：
   - 中国预测学的源头
   - 与八字、紫微的关系与区别（对比表格）
   - 三大预测体系的互补关系
   - 周易的独特优势
5. **现代研究与应用价值**：
   - 数理逻辑的现代诠释
   - 心理学视角的解读
   - 决策管理中的应用
   - 文化传承的意义
6. **学习路径与方法**：
   - 初学者入门建议
   - 核心典籍推荐
   - 学习阶段规划
   - 常见误区避免
7. **参考资源**：
   - 经典文献书目
   - 现代研究著作
   - 在线学习资源

要求：
- 引用《周易》《易传》《周易本义》等经典原文
- 结合朱熹、程颐等历代学者观点
- 引用现代学术研究成果（北大、清华等高校研究）
- 包含对比表格（周易vs八字vs紫微）
- 阐述哲学价值、文化价值和实用价值
- 适合零基础读者系统学习
- 语言严谨但不晦涩`
  },
  {
    filename: 'bagua.md',
    title: '八卦详解：从乾坤到离坎的象征体系',
    description: '深入解析八卦的形成原理、象征意义、相互关系及在占卜中的具体应用',
    keywords: ['八卦', '乾坤', '震巽', '坎离', '艮兑', '八卦类象', '先天八卦', '后天八卦'],
    author: '周易研究团队',
    prompt: `请撰写一篇5500-6500字的八卦详解文章，内容包括：

1. **八卦的起源与形成**：
   - 伏羲八卦的传说与符号起源
   - 文王八卦的演变与发展
   - 先天八卦与后天八卦的区别（对比表格）
   - 先天为体、后天为用的哲学意义
2. **八卦基本属性总表**：
   - 制作完整的八卦属性表格（卦名、卦象、卦数、五行、方位、时节、家庭成员等）
3. **八个卦象的详细解析**：
   每卦包含以下内容：
   - **乾卦☰（天）**：卦象、卦辞、象传、属性、方位、五行、数字、时节、人物、身体、性格、类象
   - **坤卦☷（地）**：同上结构
   - **震卦☳（雷）**：同上结构
   - **巽卦☴（风）**：同上结构
   - **坎卦☵（水）**：同上结构
   - **离卦☲（火）**：同上结构
   - **艮卦☶（山）**：同上结构
   - **兑卦☱（泽）**：同上结构
4. **八卦相互关系**：
   - 八卦生克关系图解
   - 相生关系的应用
   - 相克关系的判断
   - 八卦相荡原理
5. **八卦方位系统**：
   - 先天八卦方位图
   - 后天八卦方位图
   - 方位的应用价值
6. **八卦在占卜中的应用**：
   - 单卦的基本含义
   - 上下卦的组合规律
   - 卦象的动态变化
7. **记忆技巧与学习方法**：
   - 八卦卦象记忆口诀
   - 八卦类象联想记忆法
   - 系统学习建议

要求：
- 引用《说卦传》等经典原文
- 每个卦象必须包含完整的属性信息
- 配合多个图表（属性表、方位图、生克关系图）
- 提供实用的记忆口诀
- 实用性强，便于速查
- 适合作为工具书使用`
  },
  {
    filename: 'liuyao.md',
    title: '六爻占卜入门：从起卦到解卦的完整流程',
    description: '详解六爻占卜的基本原理、起卦方法、装卦技巧及解卦要点',
    keywords: ['六爻', '占卜', '起卦', '装卦', '解卦', '世应', '六亲', '六神'],
    author: '周易研究团队',
    prompt: `请撰写一篇5000-6000字的六爻占卜入门文章，内容包括：

1. **六爻占卜的理论基础**：
   - 六爻的起源与发展（引用《京房易传》等）
   - 六爻与周易的关系
   - 六爻的哲学基础
   - 六爻占卜的适用范围
2. **起卦方法详解**：
   - **铜钱摇卦法**（传统标准方法）：
     * 准备工作与注意事项
     * 具体操作步骤（配图说明）
     * 如何记录卦象
   - **时间起卦法**（梅花易数）：
     * 取数规则
     * 计算方法
     * 实例演示
   - **数字起卦法**：
     * 现代应用方法
     * 在线起卦原理
3. **装卦技巧完全指南**：
   - **装地支**：
     * 纳甲法则表格
     * 八宫归属
     * 装卦步骤
   - **装六亲**：
     * 六亲关系表（我克、克我、生我、我生、比和）
     * 六亲含义
     * 装六亲方法
   - **装六神**：
     * 青龙、朱雀、勾陈、腾蛇、白虎、玄武
     * 六神属性与作用
     * 装六神规则
   - **定世应**：
     * 世应口诀
     * 世应位置表
     * 世应含义
4. **核心概念深度解析**：
   - **用神**：取用神的原则与方法
   - **原神、忌神、仇神**：三神关系图解
   - **动爻与变爻**：动静变化的意义
   - **日月建**：月令日辰的作用力
   - **空亡**：空亡的判断与影响
   - **六冲六合**：爻位关系
5. **解卦基础要点**：
   - 旺相休囚死的判断
   - 生克制化的应用
   - 用神强弱分析
   - 吉凶基本判断
6. **常见占卜类型入门**：
   - 婚姻感情：用神取法与判断要点
   - 事业工作：用神取法与判断要点
   - 财运投资：用神取法与判断要点
   - 健康疾病：用神取法与判断要点
7. **初学者注意事项**：
   - 起卦的心态要求
   - 占卜的伦理规范
   - 常见错误避免
   - 学习建议与资源
8. **完整实例演示**：
   - 从起卦到装卦到解卦的完整流程
   - 每个步骤的详细说明

要求：
- 引用《增删卜易》《卜筮正宗》等六爻经典
- 包含多个表格（纳甲表、六亲表、六神表、世应表）
- 配合图示说明装卦过程
- 步骤清晰、易于操作
- 每个概念都有实例说明
- 适合完全零基础的初学者`
  },
  {
    filename: 'hexagrams.md',
    title: '64卦详解：卦辞爻辞深度解析',
    description: '系统解读六十四卦的卦象、卦辞、爻辞及占断应用',
    keywords: ['六十四卦', '卦辞', '爻辞', '卦象', '卦义', '周易本义'],
    author: '周易研究团队',
    prompt: `请撰写一篇6000-7000字的64卦详解文章，内容包括：

1. **六十四卦的形成原理**：
   - 八卦相重的数学原理
   - 二进制思想的体现
   - 六十四卦的哲学意义
   - 64卦与自然万物的对应
2. **六十四卦的分类与排列**：
   - 八宫归属表（完整64卦分类表格）
   - 上下经的划分
   - 《序卦传》的排列逻辑
   - 帛书易与传世本的差异
3. **六十四卦速查表**：
   - 制作完整的64卦速查表格
   - 包含：卦名、卦象、卦辞、上下卦组成、卦序、所属宫
4. **重点卦象详解**（精选18个核心卦）：
   **乾坤为首**：
   - 01.乾为天☰☰：卦象、卦辞、象传、彖传、重点爻辞、应用领域
   - 02.坤为地☷☷：同上结构
   
   **屯蒙需讼等序卦**：
   - 03.水雷屯：初创艰难之象
   - 04.山水蒙：启蒙教育之象
   - 05.水天需：等待时机之象
   - 06.天水讼：诉讼争执之象
   
   **常用重要卦**：
   - 11.地天泰：通泰顺利之象
   - 12.天地否：阻塞不通之象
   - 23.山地剥：剥落衰败之象
   - 24.地雷复：复苏回转之象
   - 29.坎为水：险难困境之象
   - 30.离为火：光明依附之象
   - 63.水火既济：功成已定之象
   - 64.火水未济：事未完成之象
   
   每卦包含：
   - 卦象与卦序
   - 卦辞原文与白话解释
   - 象传与彖传精要
   - 重点爻辞解读
   - 现代应用场景
   - 占卜含义
5. **卦象的变化规律**：
   - 爻变原理
   - 之卦的形成
   - 动爻的意义
   - 变卦的解读方法
6. **卦象关系深度解析**：
   - **上下卦的组合关系**：内外卦、贵贱位
   - **互卦**：中爻互卦的取法与意义
   - **错卦**：阴阳全变的对待关系
   - **综卦**：倒转之卦的对应关系
   - **四卦关系图示**
7. **如何查阅和使用64卦**：
   - 按卦名查询方法
   - 按卦象查询方法
   - 按上下卦组合查询
   - 数字查卦技巧
   - 在线工具推荐

要求：
- 大量引用《周易》原文（卦辞、爻辞、象传）
- 提供白话文翻译和现代解读
- 包含完整的64卦速查表格
- 包含八宫分类表格
- 重点卦象深度解析
- 配合卦象图示
- 便于查阅使用，可作为工具书
- 引用朱熹《周易本义》等权威注解`
  },
  {
    filename: 'divination-methods.md',
    title: '占卜方法与技巧：提升预测准确度的实战经验',
    description: '总结六爻占卜的高级技法、判断思路及实战经验',
    keywords: ['占卜技巧', '断卦方法', '用神取用', '动爻分析', '进退神', '飞神伏神'],
    author: '周易研究团队',
    prompt: `请撰写一篇5000-6000字的占卜方法与技巧文章，内容包括：

1. **用神取用技巧**：
   - 不同占问类型的用神选择
   - 婚姻感情用神（世应、妻财、官鬼）
   - 事业工作用神（官鬼、父母）
   - 财运投资用神（妻财、子孙）
   - 健康疾病用神（官鬼、世爻）
   - 考试升学用神（父母、官鬼）
   - 特殊情况的用神处理
2. **旺衰判断方法**：
   - 月令旺衰表（十二地支旺相休囚死）
   - 日辰生克权重
   - 动爻影响分析
   - 旺衰综合判断法
   - 旺衰与吉凶的关系
3. **动爻与变卦分析**：
   - 动爻的层次（一爻动、二爻动、多爻动）
   - 动爻的作用力分析
   - 变卦的解读方法
   - 动爻生克变化的判断
   - 化进化退、化吉化凶
4. **进退神、飞神伏神**：
   - 进神退神的定义与判断
   - 飞神伏神的取法与作用
   - 伏神旺衰的判断
   - 飞伏生克关系
   - 实例分析
5. **六神的高级运用**：
   - 青龙：喜庆、顺利、财喜
   - 朱雀：口舌、文书、信息
   - 勾陈：田土、牵连、迟缓
   - 腾蛇：虚惊、怪异、纠缠
   - 白虎：凶险、血光、丧事
   - 玄武：暗昧、盗贼、奸诈
   - 六神与六亲的组合判断
6. **各类占断要点详解**：
   - **婚姻感情占断**：
     * 看世应关系
     * 看妻财官鬼
     * 看六合六冲
     * 看用神旺衰
     * 具体实例3个
   - **事业工作占断**：
     * 看官鬼爻
     * 看父母爻
     * 看世爻强弱
     * 具体实例3个
   - **财运投资占断**：
     * 看妻财爻
     * 看子孙爻
     * 看动爻关系
     * 具体实例2个
   - **健康疾病占断**：
     * 看官鬼爻
     * 看用神爻
     * 看六神配置
     * 具体实例2个
   - **考试升学占断**：
     * 看父母爻
     * 看官鬼爻
     * 看世爻旺衰
     * 具体实例2个
7. **应期推算方法**：
   - 应期的基本原则
   - 生旺墓绝法
   - 冲合应期法
   - 值日应期法
   - 综合应期判断
8. **常见错误与避坑指南**：
   - 起卦时的常见错误
   - 装卦中的易错点
   - 解卦时的误区
   - 用神取错的情况
   - 判断失误的原因分析
9. **提升准确度的经验总结**：
   - 积累案例的重要性
   - 灵活运用的技巧
   - 多角度验证方法
   - 持续学习建议

要求：
- 引用《增删卜易》《卜筮正宗》《易隐》等经典断法
- 实战性强，每个要点都有具体案例
- 技巧归纳清晰，便于记忆
- 避免玄虚，注重实用方法
- 包含旺衰判断表格
- 至少15个不同类型的实例`
  },
  {
    filename: 'interpretation.md',
    title: '卦象解读技巧：从卦象到人事的思维转换',
    description: '掌握卦象分析的思维方法，提升解卦的灵活性和准确性',
    keywords: ['卦象解读', '象数思维', '取象比类', '综合分析', '应期推算'],
    author: '周易研究团队',
    prompt: `请撰写一篇4500-5500字的卦象解读技巧文章，内容包括：

1. **取象比类的思维方法**：
   - 什么是取象比类
   - 《说卦传》的取象思想
   - 从抽象到具体的思维转换
   - 联想思维的训练方法
   - 多层次取象（卦象、爻象、六亲、六神）
2. **卦象与现实事物的对应关系**：
   - 八卦的基本类象
   - 组合卦的类象延伸
   - 六爻位的类象含义
   - 动静变化的类象意义
   - 时空因素的类象考量
3. **综合分析技巧的五个维度**：
   - **卦象分析**：
     * 上下卦的组合含义
     * 内外卦的关系
     * 卦象整体气势
     * 卦名的参考价值
   - **爻位分析**：
     * 初爻至上爻的位置意义
     * 当位与失位
     * 中正之位的吉凶
     * 爻位与时间空间的对应
   - **六亲分析**：
     * 五行生克关系
     * 六亲之间的制化
     * 六亲旺衰的影响
     * 六亲组合的含义
   - **六神分析**：
     * 六神的象征意义
     * 六神与六亲的配合
     * 六神的吉凶偏向
     * 六神的细节信息
   - **动静分析**：
     * 静爻的稳定性
     * 动爻的变化性
     * 暗动、日破的处理
     * 动静结合的判断
4. **应期推算详解**：
   - 应期的基本理论
   - 生旺应期法（长生、帝旺）
   - 墓库应期法（入墓、冲墓）
   - 冲合应期法（逢冲、逢合）
   - 值日应期法（地支当值）
   - 应期的远近判断
   - 应期推算实例5个
5. **细节信息的提取技巧**：
   - 从卦象提取方位信息
   - 从六神提取性格特征
   - 从爻位提取时间信息
   - 从六亲提取人物关系
   - 从动爻提取事态发展
   - 多维信息的综合运用
6. **变卦与时间演变**：
   - 本卦与变卦的关系
   - 变卦的事态发展含义
   - 多动爻的演变分析
   - 从变卦看结果走向
7. **灵活解读的要点**：
   - 避免机械套用
   - 结合实际情况分析
   - 从多角度验证判断
   - 培养直觉思维
   - 经验积累的重要性
8. **思维训练方法**：
   - 每日一卦练习
   - 案例分析积累
   - 反思总结习惯
   - 跟踪验证方法
9. **完整解卦流程示例**（2-3个详细案例）：
   - 展示从起卦到最终判断的完整思维过程
   - 每个步骤的分析要点
   - 多维度信息的综合运用

要求：
- 强调思维方法而非死记硬背
- 每个技巧都配合具体案例说明
- 体现灵活性和综合性
- 引用古籍中的经典论述
- 实用性强，可操作性强
- 培养读者的分析思维能力`
  },
  {
    filename: 'practical-cases.md',
    title: '六爻实战案例：真实占断的分析与验证',
    description: '通过真实案例展示六爻占卜的完整流程和准确性验证',
    keywords: ['六爻案例', '实战占断', '案例分析', '验证反馈', '占卜经验'],
    author: '周易研究团队',
    prompt: `请撰写一篇4500-5500字的六爻实战案例文章，内容包括：

**案例结构说明**：每个案例必须包含完整的7个部分

1. **婚姻感情类案例（4个）**：
   
   **案例1：测婚姻是否和顺**
   - 占问事项：具体问题描述
   - 起卦时间：年月日时
   - 起卦过程：摇卦记录或起卦方法
   - 卦象呈现：主卦、变卦
   - 装卦分析：地支、六亲、六神、世应
   - 详细分析：用神、旺衰、动爻、六神、世应关系
   - 断卦结论：明确的吉凶判断
   - 应验反馈：实际结果验证（时间、事件）
   - 经验总结：此案例的要点启示
   
   **案例2-4**：结构同上，分别涉及：
   - 测何时结婚
   - 测感情是否复合
   - 测对方心意

2. **事业工作类案例（4个）**：
   
   **案例1：测求职能否成功**
   - 完整的七部分结构（同上）
   
   **案例2-4**：分别涉及：
   - 测工作变动吉凶
   - 测升职机会
   - 测创业项目前景

3. **财运投资类案例（3个）**：
   
   **案例1：测投资项目盈亏**
   - 完整的七部分结构
   
   **案例2-3**：分别涉及：
   - 测财运走势
   - 测借贷能否收回

4. **健康疾病类案例（3个）**：
   
   **案例1：测疾病吉凶**
   - 完整的七部分结构
   
   **案例2-3**：分别涉及：
   - 测病情发展
   - 测医疗效果

5. **其他类型案例（2个）**：
   - 测考试结果
   - 测失物能否找回

6. **案例分析总结**：
   - 共性规律提炼
   - 判断要点归纳
   - 常见错误分析
   - 准确率提升方法

**整体要求**：
- 案例必须真实可信，有时间地点
- 每个案例分析过程要详细，思路清晰
- 必须有实际应验反馈，说明准确性
- 卦象要用标准格式呈现（六爻排列）
- 分析要体现多维度综合判断
- 每类案例覆盖不同的判断要点
- 总计16个完整案例
- 体现六爻占卜的实用价值
- 给初学者提供学习模板`
  },
  {
    filename: 'ai-application.md',
    title: 'AI技术在周易占卜中的创新应用',
    description: '探索人工智能如何辅助周易占卜，提升分析效率和准确性',
    keywords: ['AI占卜', '人工智能', '周易AI', '智能解卦', '机器学习', '知识图谱'],
    author: 'AI玄学研究团队',
    prompt: `请撰写一篇4500-5500字的AI在周易中的应用文章，内容包括：

1. **引言：AI与周易的结合契机**：
   - 周易的计算复杂性需求
   - AI技术的发展现状
   - 传统文化数字化的意义
   - 结合的可行性分析
2. **AI技术在周易领域的应用场景**：
   - 智能起卦与排盘
   - 自动装卦系统
   - 智能解卦辅助
   - 知识库检索
   - 案例学习与推荐
   - 应期精准计算
3. **智能起卦系统的实现**：
   - 随机数生成算法
   - 时间起卦的编程实现
   - 虚拟摇卦的算法设计
   - 起卦结果的验证
4. **AI辅助装卦与分析**：
   - 纳甲装卦的自动化
   - 六亲六神的智能配置
   - 世应的自动判定
   - 装卦准确性保证
5. **机器学习在卦象识别中的应用**：
   - 卦象特征提取
   - 模式识别算法
   - 分类模型训练
   - 预测准确率分析
6. **知识图谱构建64卦关系网络**：
   - 本体建模方法
   - 卦象关系抽取
   - 互卦、错卦、综卦关系网络
   - 知识推理应用
   - 图数据库实现（Neo4j）
7. **NLP技术解读卦辞爻辞**：
   - 古文语义分析
   - 实体识别与关系抽取
   - 现代语言转换
   - 多版本注解整合
8. **AI与传统占卜的结合方式**：
   - 人机协同模式
   - AI作为辅助工具的定位
   - 传统直觉与AI计算的配合
   - 保留传统精髓的重要性
9. **天机爻AI六爻系统介绍**：
   - 系统架构设计
   - 核心功能模块
   - 用户使用流程
   - 技术特色与优势
   - 实际案例演示
10. **技术实现细节**（示例代码）：
    - 起卦算法代码示例（Python）
    - 装卦逻辑代码片段
    - 简单的判断规则实现
11. **技术局限性与挑战**：
    - 直觉思维难以模拟
    - 灵活性不足
    - 文化语境理解困难
    - 小样本学习问题
    - 可解释性挑战
12. **未来展望**：
    - 深度学习的应用前景
    - 大语言模型的潜力
    - 多模态分析可能性
    - 个性化推荐系统
    - 文化传承与技术创新的平衡

要求：
- 技术与传统命理知识结合
- 包含系统架构图（文字描述）
- 提供代码示例（Python为主）
- 介绍天机爻实际产品功能
- 引用AI相关学术研究
- 保持理性客观态度
- 明确AI的辅助定位
- 强调文化传承的重要性
- 展望技术发展趋势
- 适合技术人员和传统命理爱好者阅读`
  }
];

async function generateDocument(doc, index, total) {
  console.log(`\n📝 [${index + 1}/${total}] 开始生成: ${doc.title}`);
  console.log(`   文件: ${doc.filename}`);
  
  try {
    console.log('   🤖 调用DeepSeek API...');
    
    const response = await axios.post(
      DEEPSEEK_API_URL,
      {
        model: 'deepseek-chat',
        messages: [
          {
            role: 'system',
            content: '你是周易研究专家，擅长撰写系统化的周易八卦教程。确保内容准确、结构清晰、实用性强。'
          },
          {
            role: 'user',
            content: doc.prompt
          }
        ],
        temperature: 0.7,
        max_tokens: 8000
      },
      {
        headers: {
          'Authorization': `Bearer ${DEEPSEEK_API_KEY}`,
          'Content-Type': 'application/json'
        },
        timeout: 240000  // 4分钟超时
      }
    );
    
    const content = response.data.choices[0].message.content;
    console.log(`   ✅ 内容生成成功 (${content.length} 字符)`);
    
    // 构建完整的文档内容
    const frontMatter = `---
layout: default
title: ${doc.title}
description: ${doc.description}
keywords: [${doc.keywords.join(', ')}]
author: ${doc.author}
date: ${new Date().toISOString().split('T')[0]}
---

`;

    const relatedLinks = `

---

## 📚 相关阅读

- [返回周易首页](./index.md)
- [八字命理](../bazi/index.md)
- [紫微斗数](../ziwei/index.md)
- [AI与传统玄学](../ai/ai-introduction.md)
- [返回首页](../index.md)
`;

    const fullContent = frontMatter + content + relatedLinks;
    
    // 保存文件
    const filePath = path.join(__dirname, 'docs/yijing', doc.filename);
    fs.writeFileSync(filePath, fullContent, 'utf-8');
    
    console.log(`   💾 文件已保存: docs/yijing/${doc.filename}`);
    
    return { success: true, filename: doc.filename };
    
  } catch (error) {
    console.error(`   ❌ 生成失败: ${error.message}`);
    return { success: false, filename: doc.filename, error: error.message };
  }
}

async function main() {
  console.log('🎯 开始创建周易八卦模块文档');
  console.log(`📊 计划生成 ${documents.length} 个文档\n`);
  
  if (!DEEPSEEK_API_KEY) {
    console.error('❌ 未找到DEEPSEEK_API_KEY环境变量');
    process.exit(1);
  }
  
  // 确保目录存在
  const yijingDir = path.join(__dirname, 'docs/yijing');
  if (!fs.existsSync(yijingDir)) {
    fs.mkdirSync(yijingDir, { recursive: true });
    console.log('✓ 创建目录: docs/yijing\n');
  }
  
  const results = [];
  
  // 逐个生成文档
  for (let i = 0; i < documents.length; i++) {
    const result = await generateDocument(documents[i], i, documents.length);
    results.push(result);
    
    // 等待2秒再处理下一个（避免API限流）
    if (i < documents.length - 1) {
      console.log('   ⏳ 等待2秒...');
      await new Promise(resolve => setTimeout(resolve, 2000));
    }
  }
  
  // 统计结果
  console.log('\n' + '='.repeat(60));
  console.log('📊 生成结果统计\n');
  
  const successful = results.filter(r => r.success);
  const failed = results.filter(r => !r.success);
  
  console.log(`✅ 成功: ${successful.length}/${documents.length}`);
  if (successful.length > 0) {
    successful.forEach(r => console.log(`   ✓ ${r.filename}`));
  }
  
  if (failed.length > 0) {
    console.log(`\n❌ 失败: ${failed.length}/${documents.length}`);
    failed.forEach(r => console.log(`   ✗ ${r.filename} - ${r.error}`));
  }
  
  console.log('\n' + '='.repeat(60));
  
  if (failed.length > 0) {
    console.log('\n💡 对于失败的文档，可以运行:');
    console.log('   node create-single-yijing-doc.js <filename>');
  } else {
    console.log('\n🎉 所有文档生成完成！');
    console.log('\n📋 下一步:');
    console.log('   1. npm run analyze       # 运行质量分析');
    console.log('   2. 人工审阅文档内容');
    console.log('   3. 更新首页添加周易模块入口');
    console.log('   4. git add && git commit && git push');
  }
}

main().catch(error => {
  console.error('\n❌ 程序执行出错:', error);
  process.exit(1);
});
